import{$ as be,A as I,B as $,C as H,D as ce,E as W,F as de,G as pe,H as me,I as ue,J as V,K as fe,L as ge,M as _e,N as J,O as L,P as he,Q as ve,R as Se,S as Ce,T as ye,U as Q,V as M,W as Z,X as Me,Y as Ee,Z as xe,_ as Te,a as j,aa as Oe,b as ie,ba as ke,c as Y,ca as we,d as re,da as Pe,e as X,ea as Ne,f as C,fa as Ae,g as h,ga as Ie,h as ae,ha as v,i as b,ia as z,j as O,ja as Le,k as se,l as c,m as y,n as F,o as m,p as u,q as r,r as a,s as le,t as k,u as w,v as g,w as l,x as P,y as N,z as A}from"./chunk-SPF744YH.js";var q="@@STATE",D=(function(e){return e[e.LocalStorage=0]="LocalStorage",e[e.SessionStorage=1]="SessionStorage",e})(D||{}),U=new C(""),De=new C("",{providedIn:"root",factory:()=>h(U).keys==="*"}),R=new C(""),ee=new C("");function te(e){return!!e?.engine}function Re(e){return te(e)&&(e=e.key),L(e,J)&&(e=e[J].name),e instanceof he?e.getName():e}function Be(e){return ie(j({storage:D.LocalStorage,serialize:JSON.stringify,deserialize:JSON.parse,beforeSerialize:n=>n,afterDeserialize:n=>n},e),{keys:e.keys==="*"?[q]:e.keys})}function Ye(e){return e.storage===D.LocalStorage?localStorage:e.storage===D.SessionStorage?sessionStorage:null}function Ge(e,n){return n?.namespace?`${n.namespace}:${e}`:e}var Xe=(()=>{class e{_keys=new Set;_injector=h(se);_keysWithEngines=[];constructor(){let{keys:t}=h(R);this.addKeys(t)}getKeysWithEngines(){return[...this._keysWithEngines]}addKeys(t){for(let o of t){let s=Re(o);if(this._keys.has(s))continue;this._keys.add(s);let i=te(o)?this._injector.get(o.engine):this._injector.get(ee);this._keysWithEngines.push({key:s,engine:i})}}static \u0275fac=function(o){return new(o||e)};static \u0275prov=X({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})(),$e=(()=>{class e{_keysManager=h(Xe);_options=h(R);_allStatesPersisted=h(De);handle(t,o,s){let i=Ce(o),T=i(ve),_=i(Se),ne=T||_,oe=!1;if(ne){let S=_&&o.addedStates;for(let{key:f,engine:K}of this._keysManager.getKeysWithEngines()){if(!this._allStatesPersisted&&S){let p=f.indexOf(He),B=p>-1?f.slice(0,p):f;if(!L(S,B))continue}let G=Ge(f,this._options),d=K.getItem(G);if(d!=="undefined"&&d!=null){try{let p=this._options.deserialize(d);d=this._options.afterDeserialize(p,f)}catch{d={}}this._options.migrations?.forEach(p=>{let B=p.version===Q(d,p.versionKey||"version"),Ke=!p.key&&this._allStatesPersisted||p.key===f;B&&Ke&&(d=p.migrate(d),oe=!0)}),this._allStatesPersisted?(d=this._hydrateSelectivelyOnUpdate(d,S),t=j(j({},t),d)):t=ye(t,f,d)}}}return s(t,o).pipe(re(S=>{if(!(ne&&!oe))for(let{key:f,engine:K}of this._keysManager.getKeysWithEngines()){let G=S,d=Ge(f,this._options);f!==q&&(G=Q(S,f));try{let p=this._options.beforeSerialize(G,f);K.setItem(d,this._options.serialize(p))}catch{}}}))}_hydrateSelectivelyOnUpdate(t,o){return!t||!o||Object.keys(o).length===0?t:Object.keys(o).reduce((s,i)=>(L(t,i)&&(s[i]=t[i]),s),{})}static \u0275fac=function(o){return new(o||e)};static \u0275prov=X({token:e,factory:e.\u0275fac})}return e})(),He=".";function Fe(e){return ae([Ee($e),{provide:U,useValue:e},{provide:R,useFactory:Be,deps:[U]},{provide:ee,useFactory:Ye,deps:[R]}])}function Ze(e,n){e&1&&(r(0,"h2"),l(1,"Connexion"),a())}function qe(e,n){e&1&&(r(0,"h2"),l(1,"Cr\xE9er un compte"),a())}function et(e,n){if(e&1){let t=k();r(0,"div",2)(1,"label"),l(2,"Firstname"),a(),r(3,"input",8),I("ngModelChange",function(s){b(t);let i=g();return A(i.firstname,s)||(i.firstname=s),O(s)}),a()()}if(e&2){let t=g();c(3),N("ngModel",t.firstname)}}function tt(e,n){if(e&1){let t=k();r(0,"div",2)(1,"label"),l(2,"Lastname"),a(),r(3,"input",9),I("ngModelChange",function(s){b(t);let i=g();return A(i.lastname,s)||(i.lastname=s),O(s)}),a()()}if(e&2){let t=g();c(3),N("ngModel",t.lastname)}}function nt(e,n){if(e&1&&(r(0,"div",5),l(1),a()),e&2){let t=g();c(),P(t.error)}}function ot(e,n){e&1&&l(0," Cr\xE9er le compte ")}function it(e,n){e&1&&l(0," Se connecter ")}function rt(e,n){e&1&&l(0," J'ai d\xE9j\xE0 un compte ")}function at(e,n){e&1&&l(0," Cr\xE9er un compte ")}var We=(()=>{let n=class n{constructor(o,s){this.store=o,this.router=s,this.firstname="",this.lastname="",this.login="",this.password="",this.error="",this.signupMode=!1}submit(){this.error="",this.signupMode?this.store.dispatch(new Ie(this.login,this.password,this.firstname,this.lastname)).subscribe({next:()=>{this.store.selectSnapshot(v.getAccessToken)?this.router.navigate(["/pollution/list"]):this.error="Impossible de cr\xE9er le compte (login peut exister)"},error:o=>{this.error="Erreur lors de l'inscription"}}):this.store.dispatch(new Ne(this.login,this.password)).subscribe({next:()=>{this.store.selectSnapshot(v.getAccessToken)?this.router.navigate(["/pollution/list"]):this.error="Identifiants invalides"},error:o=>{this.error="Erreur de connexion"}})}toggleSignup(){this.signupMode=!this.signupMode,this.error=""}};n.\u0275fac=function(s){return new(s||n)(y(M),y(V))},n.\u0275cmp=F({type:n,selectors:[["app-login"]],decls:21,vars:9,consts:[[1,"login-container"],[3,"ngSubmit"],[1,"form-group"],["name","login",1,"form-control",3,"ngModelChange","ngModel"],["type","password","name","password",1,"form-control",3,"ngModelChange","ngModel"],[1,"error"],["type","submit",1,"btn","btn-primary"],["type","button",1,"btn","btn-link",3,"click"],["name","firstname",1,"form-control",3,"ngModelChange","ngModel"],["name","lastname",1,"form-control",3,"ngModelChange","ngModel"]],template:function(s,i){s&1&&(r(0,"div",0),m(1,Ze,2,0,"h2"),m(2,qe,2,0,"h2"),r(3,"form",1),w("ngSubmit",function(){return i.submit()}),m(4,et,4,1,"div",2),m(5,tt,4,1,"div",2),r(6,"div",2)(7,"label"),l(8,"Login"),a(),r(9,"input",3),I("ngModelChange",function(_){return A(i.login,_)||(i.login=_),_}),a()(),r(10,"div",2)(11,"label"),l(12,"Mot de passe"),a(),r(13,"input",4),I("ngModelChange",function(_){return A(i.password,_)||(i.password=_),_}),a()(),m(14,nt,2,1,"div",5),r(15,"button",6),m(16,ot,1,0)(17,it,1,0),a(),r(18,"button",7),w("click",function(){return i.toggleSignup()}),m(19,rt,1,0)(20,at,1,0),a()()()),s&2&&(c(),u(i.signupMode?-1:1),c(),u(i.signupMode?2:-1),c(2),u(i.signupMode?4:-1),c(),u(i.signupMode?5:-1),c(4),N("ngModel",i.login),c(4),N("ngModel",i.password),c(),u(i.error?14:-1),c(2),u(i.signupMode?16:17),c(3),u(i.signupMode?19:20))},dependencies:[W,Pe,we,xe,Te,be,ke,Oe],styles:[".login-container[_ngcontent-%COMP%]{max-width:420px;margin:24px auto;padding:16px;background:#fff;border-radius:8px;box-shadow:0 2px 8px #00000014}.form-group[_ngcontent-%COMP%]{margin-bottom:12px}.form-control[_ngcontent-%COMP%]{width:100%;padding:8px}.error[_ngcontent-%COMP%]{color:#b00020;margin-bottom:8px}"]});let e=n;return e})();var Ve=[{path:"login",component:We},{path:"",redirectTo:"/pollution/list",pathMatch:"full"},{path:"pollution",loadChildren:()=>import("./chunk-DZAFGOZI.js").then(e=>e.PollutionModule)},{path:"**",redirectTo:"/pollution/list"}];var ze=(e,n)=>{let o=h(M).selectSnapshot(v.getAccessToken);return o&&(e=e.clone({setHeaders:{Authorization:`Bearer ${o}`}})),n(e)};var Ue={providers:[_e(Ve),pe(me([ze])),Me([z,v],Fe({keys:["favorites"]}))]};function st(e,n){if(e&1&&(r(0,"span",11),l(1),$(2,"async"),a()),e&2){let t=g(2);c(),P(H(2,1,t.favoritesCount$))}}function lt(e,n){if(e&1&&(r(0,"a",6),l(1," \u{1F499} Favoris "),m(2,st,3,3,"span",11),$(3,"async"),a()),e&2){let t=g();c(2),u(H(3,1,t.favoritesCount$)>0?2:-1)}}function ct(e,n){e&1&&(r(0,"a",7),l(1," \u{1F510} Connexion "),a())}function dt(e,n){if(e&1){let t=k();r(0,"div",8)(1,"span"),l(2),a(),r(3,"button",12),w("click",function(){b(t);let s=g();return O(s.logout())}),l(4,"Se d\xE9connecter"),a()()}if(e&2){let t=g();c(2),P(t.userName)}}var E=class E{constructor(n,t){this.store=n,this.router=t,this.title="Pollution Tracker",this.userName=""}ngOnInit(){this.user$.subscribe(n=>{this.userName=n?`${n.firstname} ${n.lastname}`:""})}logout(){this.store.dispatch(new Ae),this.router.navigate(["/login"])}};E.\u0275fac=function(t){return new(t||E)(y(M),y(V))},E.\u0275cmp=F({type:E,selectors:[["app-root"]],decls:18,vars:3,consts:[[1,"app-container"],[1,"navbar"],[1,"navbar-brand"],[1,"navbar-menu"],["routerLink","/pollution/list","routerLinkActive","active",1,"nav-link"],["routerLink","/pollution/report","routerLinkActive","active",1,"nav-link"],["routerLink","/pollution/favorites","routerLinkActive","active",1,"nav-link","favorites-link"],["routerLink","/login","routerLinkActive","active",1,"nav-link"],[1,"nav-user"],[1,"main-content"],[1,"footer"],[1,"badge"],[1,"btn","btn-link",3,"click"]],template:function(t,o){t&1&&(r(0,"div",0)(1,"nav",1)(2,"div",2)(3,"h1"),l(4,"\u{1F30D} Pollution Tracker"),a()(),r(5,"div",3)(6,"a",4),l(7," \u{1F4CB} Liste des pollutions "),a(),r(8,"a",5),l(9," \u2795 Signaler une pollution "),a(),m(10,lt,4,3,"a",6),m(11,ct,2,0,"a",7),m(12,dt,5,1,"div",8),a()(),r(13,"main",9),le(14,"router-outlet"),a(),r(15,"footer",10)(16,"p"),l(17," \xA9 2025 Pollution Tracker - Application de signalement de pollutions "),a()()()),t&2&&(c(10),u(o.userName?10:-1),c(),u(o.userName?-1:11),c(),u(o.userName?12:-1))},dependencies:[W,ue,fe,ge,Le,ce],styles:["*[_ngcontent-%COMP%]{margin:0;padding:0;box-sizing:border-box}.app-container[_ngcontent-%COMP%]{min-height:100vh;display:flex;flex-direction:column;background-color:#f5f6fa}.navbar[_ngcontent-%COMP%]{background:linear-gradient(135deg,#667eea,#764ba2);color:#fff;padding:.9375rem 1.875rem;display:flex;justify-content:space-between;align-items:center;box-shadow:0 .25rem .75rem #00000026}.navbar-brand[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:1.8rem;font-weight:700;margin:0}.navbar-menu[_ngcontent-%COMP%]{display:flex;gap:1.25rem}.nav-link[_ngcontent-%COMP%]{color:#fff;text-decoration:none;padding:.625rem 1.25rem;border-radius:.375rem;font-weight:500;transition:all .3s;background:#ffffff1a}.nav-link[_ngcontent-%COMP%]:hover{background:#fff3;transform:translateY(-.125rem)}.nav-link.active[_ngcontent-%COMP%]{background:#ffffff4d;font-weight:700}.favorites-link[_ngcontent-%COMP%]{position:relative}.badge[_ngcontent-%COMP%]{position:absolute;top:-.375rem;right:-.375rem;background:#dc3545;color:#fff;border-radius:50%;padding:.15rem .5rem;font-size:.75rem;font-weight:700;min-width:1.25rem;text-align:center;box-shadow:0 .125rem .25rem #0003}.nav-user[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.625rem;color:#fff}.btn-link[_ngcontent-%COMP%]{background:none;border:none;color:#fff;cursor:pointer;text-decoration:underline;font-size:.875rem}.btn-link[_ngcontent-%COMP%]:hover{color:#f0f0f0}.main-content[_ngcontent-%COMP%]{flex:1;padding:1.25rem;max-width:100%}.footer[_ngcontent-%COMP%]{background:#2c3e50;color:#fff;text-align:center;padding:1.25rem;margin-top:auto}.footer[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;font-size:.9rem}@media (max-width: 48rem){.navbar[_ngcontent-%COMP%]{flex-direction:column;gap:.9375rem;padding:.9375rem 1.25rem}.navbar-brand[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:1.5rem}.navbar-menu[_ngcontent-%COMP%]{width:100%;flex-direction:column;gap:.625rem}.nav-link[_ngcontent-%COMP%]{text-align:center}.main-content[_ngcontent-%COMP%]{padding:.625rem}}"]});var x=E;Y([Z(z.getFavoritesCount)],x.prototype,"favoritesCount$",void 0);Y([Z(v.getUser)],x.prototype,"user$",void 0);de(x,Ue).catch(e=>console.error(e));
